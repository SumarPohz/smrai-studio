<%
  // Parse references (same pattern as bold-sidebar)
  const rawRefs = (data.references || "").trim();
  const refEntries = rawRefs
    ? rawRefs.split(/\n?---\n?|\n{2,}/).map(s => s.trim()).filter(Boolean).slice(0, 3)
    : [];
%>

<div class="cg-header-bar">
  <% if (data.profileImageUrl) { %>
    <img class="cg-profile-photo" src="<%= data.profileImageUrl %>" alt="Profile">
  <% } else { %>
    <div class="cg-profile-photo cg-no-photo"></div>
  <% } %>
  <div class="cg-header-text">
    <h1 class="cg-name"><%= data.fullName || "Your Name" %></h1>
    <p class="cg-role"><%= data.roleTitle || "" %></p>
  </div>
</div>

<div class="cg-main">

  <!-- LEFT SIDEBAR -->
  <div class="cg-sidebar">

    <div class="cg-sb-section">
      <h3>CONTACT</h3>
      <div class="cg-sb-divider"></div>
      <% if (data.phone)    { %><p class="cg-sb-item">üìû <%= data.phone %></p><% } %>
      <% if (data.email)    { %><p class="cg-sb-item">‚úâ <%= data.email %></p><% } %>
      <% if (data.location) { %><p class="cg-sb-item">üìç <%= data.location %></p><% } %>
    </div>

    <% if (data.education) { %>
    <div class="cg-sb-section">
      <h3>EDUCATION</h3>
      <div class="cg-sb-divider"></div>
      <p class="cg-sb-text"><%= data.education %></p>
    </div>
    <% } %>

    <div class="cg-sb-section">
      <h3>SKILLS</h3>
      <div class="cg-sb-divider"></div>
      <ul class="cg-sb-list">
        <% if (skillsLines && skillsLines.length) {
             skillsLines.forEach(function(s) { %>
          <li><%= s %></li>
        <% }); } else if (data.skills) {
             data.skills.split(/[,\n]+/).filter(function(s) { return s.trim(); }).forEach(function(s) { %>
          <li><%= s.trim() %></li>
        <% }); } %>
      </ul>
    </div>

    <% if (data.languages) { %>
    <div class="cg-sb-section">
      <h3>LANGUAGE</h3>
      <div class="cg-sb-divider"></div>
      <ul class="cg-sb-list">
        <% data.languages.split(/\n+/).filter(function(l) { return l.trim(); }).forEach(function(l) { %>
          <li><%= l %></li>
        <% }); %>
      </ul>
    </div>
    <% } %>

  </div><!-- /.cg-sidebar -->

  <!-- RIGHT CONTENT -->
  <div class="cg-content">

    <% if (data.summary) { %>
    <div class="cg-section">
      <h2>Summary</h2>
      <div class="cg-section-divider"></div>
      <p><%= data.summary %></p>
    </div>
    <% } %>

    <% if (experienceItems && experienceItems.length) { %>
    <div class="cg-section">
      <h2>Experience</h2>
      <div class="cg-section-divider"></div>
      <% experienceItems.forEach(function(exp) { %>
        <div class="cg-exp-item">
          <div class="cg-exp-header">
            <span class="cg-exp-title"><%= exp.title %></span>
            <span class="cg-exp-year"><%= exp.dates %></span>
          </div>
          <% if (exp.company) { %><p class="cg-exp-company"><%= exp.company %></p><% } %>
          <% if (exp.description) { %>
            <ul class="cg-exp-bullets">
              <% exp.description.split('\n').filter(function(l) { return l.trim(); }).forEach(function(bullet) { %>
                <li><%= bullet.replace(/^[‚Ä¢\-]\s*/, '') %></li>
              <% }); %>
            </ul>
          <% } %>
        </div>
      <% }); %>
    </div>
    <% } else if (data.experience) { %>
    <div class="cg-section">
      <h2>Experience</h2>
      <div class="cg-section-divider"></div>
      <p><%= data.experience %></p>
    </div>
    <% } %>

    <% if (refEntries.length) { %>
    <div class="cg-section">
      <h2>Reference</h2>
      <div class="cg-section-divider"></div>
      <div class="cg-refs-grid">
        <% refEntries.forEach(function(ref) {
             var rLines = ref.split('\n').filter(function(l) { return l.trim(); });
        %>
          <div class="cg-ref-card">
            <p class="cg-ref-name"><strong><%= rLines[0] || "" %></strong></p>
            <% if (rLines[1]) { %><p class="cg-ref-org"><%= rLines[1] %></p><% } %>
            <% if (rLines[2]) { %><p class="cg-ref-detail"><strong>Phone:</strong> <%= rLines[2] %></p><% } %>
            <% if (rLines[3]) { %><p class="cg-ref-detail"><strong>Email :</strong> <%= rLines[3] %></p><% } %>
          </div>
        <% }); %>
      </div>
    </div>
    <% } %>

  </div><!-- /.cg-content -->

</div><!-- /.cg-main -->
